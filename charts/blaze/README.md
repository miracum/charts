# blaze

![Type: application](https://img.shields.io/badge/Type-application-informational?style=flat-square)

A Helm chart for deploying Blaze, a FHIR® Server with internal, fast CQL Evaluation Engine.

**Homepage:** <https://github.com/samply/blaze>

## Installation

```sh
helm install blaze oci://ghcr.io/miracum/charts/blaze -n blaze
```

## Values

| Key                                               | Type   | Default                                                                                                                                                | Description                                                                                                                                                                                                                                                                                                                                   |
| ------------------------------------------------- | ------ | ------------------------------------------------------------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| affinity                                          | object | `{}`                                                                                                                                                   | pod affinity                                                                                                                                                                                                                                                                                                                                  |
| baseUrl                                           | string | `"http://{{ include \"blaze.fullname\" . }}.{{ .Release.Namespace }}.svc:{{ .Values.service.port }}"`                                                  | set the server base URL. Evaluated as a template. Equivalent to setting the `BASE_URL` environment variable.                                                                                                                                                                                                                                  |
| customSearchParameters.bundle                     | string | `""`                                                                                                                                                   | a custom search parameter bundle <https://samply.github.io/blaze/deployment/environment-variables.html#db-search-param-bundle>                                                                                                                                                                                                                |
| customSearchParameters.existingConfigmap.key      | string | `"custom-search-parameters.json"`                                                                                                                      | the key inside the config map referencing the custom search parameter bundle file.                                                                                                                                                                                                                                                            |
| customSearchParameters.existingConfigmap.name     | string | `""`                                                                                                                                                   | name of a config map containing a custom search parameter bundle file. <https://samply.github.io/blaze/deployment/environment-variables.html#db-search-param-bundle>                                                                                                                                                                          |
| enforceReferentialIntegrity                       | bool   | `true`                                                                                                                                                 | whether referential integrity should be enforced. Equivalent to setting the `ENFORCE_REFERENTIAL_INTEGRITY` environment variable.                                                                                                                                                                                                             |
| envDict                                           | object | `{}`                                                                                                                                                   | extra environment variables to set on the blaze server container in dictionary form                                                                                                                                                                                                                                                           |
| extraEnv                                          | list   | `[]`                                                                                                                                                   | extra environment variables to set on the blaze server container                                                                                                                                                                                                                                                                              |
| frontend.backendURL                               | string | `"http://{{ include \"blaze.fullname\" . }}.{{ .Release.Namespace }}.svc:{{ .Values.service.port }}"`                                                  |                                                                                                                                                                                                                                                                                                                                               |
| frontend.enabled                                  | bool   | `false`                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                               |
| frontend.envDict                                  | object | `{}`                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                               |
| frontend.extraEnv                                 | list   | `[]`                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                               |
| frontend.image.pullPolicy                         | string | `"IfNotPresent"`                                                                                                                                       |                                                                                                                                                                                                                                                                                                                                               |
| frontend.image.registry                           | string | `"ghcr.io"`                                                                                                                                            |                                                                                                                                                                                                                                                                                                                                               |
| frontend.image.repository                         | string | `"samply/blaze-frontend"`                                                                                                                              |                                                                                                                                                                                                                                                                                                                                               |
| frontend.image.tag                                | string | `"0.34.0@sha256:d56e1793e17ba95ef63e02e3ce52146ef6a341b3314aa59cc6d79301c455976c"`                                                                     |                                                                                                                                                                                                                                                                                                                                               |
| frontend.imagePullSecrets                         | list   | `[]`                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                               |
| frontend.ingressRoute                             | object | `{"backendAuthType":"Basic","enabled":false,"entryPoints":[],"host":"blaze.127.0.0.1.nip.io","middlewares":{"backend":[],"frontend":[],"metrics":[]}}` | other ingress controllers would have to make use of additional ingresses and annotations and/or their own CRDs                                                                                                                                                                                                                                |
| frontend.ingressRoute.backendAuthType             | string | `"Basic"`                                                                                                                                              | the traefik router matches based on this auth type for the backend. This auth needs to be supplied via middleware.backend.                                                                                                                                                                                                                    |
| frontend.livenessProbe.failureThreshold           | int    | `10`                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                               |
| frontend.livenessProbe.httpGet.path               | string | `"/"`                                                                                                                                                  |                                                                                                                                                                                                                                                                                                                                               |
| frontend.livenessProbe.httpGet.port               | string | `"http"`                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                               |
| frontend.livenessProbe.initialDelaySeconds        | int    | `30`                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                               |
| frontend.livenessProbe.periodSeconds              | int    | `10`                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                               |
| frontend.livenessProbe.successThreshold           | int    | `1`                                                                                                                                                    |                                                                                                                                                                                                                                                                                                                                               |
| frontend.livenessProbe.timeoutSeconds             | int    | `10`                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                               |
| frontend.origin                                   | string | `"https://blaze.localhost"`                                                                                                                            | origin needs to be set to frontend domain                                                                                                                                                                                                                                                                                                     |
| frontend.podAnnotations                           | object | `{}`                                                                                                                                                   | annotations to set on the frontend deployment's pod                                                                                                                                                                                                                                                                                           |
| frontend.readinessProbe.failureThreshold          | int    | `5`                                                                                                                                                    |                                                                                                                                                                                                                                                                                                                                               |
| frontend.readinessProbe.httpGet.path              | string | `"/"`                                                                                                                                                  |                                                                                                                                                                                                                                                                                                                                               |
| frontend.readinessProbe.httpGet.port              | string | `"http"`                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                               |
| frontend.readinessProbe.initialDelaySeconds       | int    | `30`                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                               |
| frontend.readinessProbe.periodSeconds             | int    | `10`                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                               |
| frontend.readinessProbe.successThreshold          | int    | `1`                                                                                                                                                    |                                                                                                                                                                                                                                                                                                                                               |
| frontend.readinessProbe.timeoutSeconds            | int    | `5`                                                                                                                                                    |                                                                                                                                                                                                                                                                                                                                               |
| frontend.replicaCount                             | int    | `1`                                                                                                                                                    |                                                                                                                                                                                                                                                                                                                                               |
| frontend.resources                                | object | `{}`                                                                                                                                                   | configure the resource requests and limits for the frontend pod                                                                                                                                                                                                                                                                               |
| frontend.securityContext.allowPrivilegeEscalation | bool   | `false`                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                               |
| frontend.securityContext.capabilities.drop[0]     | string | `"ALL"`                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                               |
| frontend.securityContext.readOnlyRootFilesystem   | bool   | `true`                                                                                                                                                 |                                                                                                                                                                                                                                                                                                                                               |
| frontend.securityContext.runAsGroup               | int    | `1001`                                                                                                                                                 |                                                                                                                                                                                                                                                                                                                                               |
| frontend.securityContext.runAsNonRoot             | bool   | `true`                                                                                                                                                 |                                                                                                                                                                                                                                                                                                                                               |
| frontend.securityContext.runAsUser                | int    | `1001`                                                                                                                                                 |                                                                                                                                                                                                                                                                                                                                               |
| frontend.securityContext.seccompProfile.type      | string | `"RuntimeDefault"`                                                                                                                                     |                                                                                                                                                                                                                                                                                                                                               |
| frontend.service.port                             | int    | `3000`                                                                                                                                                 | the port for the main endpoint                                                                                                                                                                                                                                                                                                                |
| frontend.service.type                             | string | `"ClusterIP"`                                                                                                                                          | type of service the frontend uses                                                                                                                                                                                                                                                                                                             |
| frontend.startupProbe.failureThreshold            | int    | `10`                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                               |
| frontend.startupProbe.httpGet.path                | string | `"/"`                                                                                                                                                  |                                                                                                                                                                                                                                                                                                                                               |
| frontend.startupProbe.httpGet.port                | string | `"http"`                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                               |
| frontend.startupProbe.initialDelaySeconds         | int    | `30`                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                               |
| frontend.startupProbe.periodSeconds               | int    | `10`                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                               |
| frontend.startupProbe.successThreshold            | int    | `1`                                                                                                                                                    |                                                                                                                                                                                                                                                                                                                                               |
| frontend.startupProbe.timeoutSeconds              | int    | `10`                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                               |
| fullnameOverride                                  | string | `""`                                                                                                                                                   | override the full release name                                                                                                                                                                                                                                                                                                                |
| imagePullSecrets                                  | list   | `[]`                                                                                                                                                   | image pull secrets used by the main deployment container                                                                                                                                                                                                                                                                                      |
| ingress.annotations                               | object | `{}`                                                                                                                                                   | extra annotations to apply to the Ingress resource                                                                                                                                                                                                                                                                                            |
| ingress.className                                 | string | `""`                                                                                                                                                   | ingressClassName to use                                                                                                                                                                                                                                                                                                                       |
| ingress.enabled                                   | bool   | `false`                                                                                                                                                | create an Ingress for the application                                                                                                                                                                                                                                                                                                         |
| ingress.hosts                                     | list   | `[{"host":"blaze.127.0.0.1.nip.io","paths":[{"path":"/","pathType":"ImplementationSpecific","portName":"http"}]}]`                                     | list of ingress hosts                                                                                                                                                                                                                                                                                                                         |
| ingress.tls                                       | list   | `[]`                                                                                                                                                   | TLS configuration                                                                                                                                                                                                                                                                                                                             |
| javaToolOptions                                   | string | `"-XX:-OmitStackTraceInFastThrow"`                                                                                                                     | sets the value for the `JAVA_TOOL_OPTIONS` environment variable.                                                                                                                                                                                                                                                                              |
| logLevel                                          | string | `"INFO"`                                                                                                                                               | the log level to set. Equivalent to setting the `LOG_LEVEL` environment variable.                                                                                                                                                                                                                                                             |
| metrics.enabled                                   | bool   | `true`                                                                                                                                                 | Enable the export of Prometheus metrics                                                                                                                                                                                                                                                                                                       |
| metrics.serviceMonitor.additionalLabels           | object | `{}`                                                                                                                                                   | additional labels to apply to the ServiceMonitor object, e.g. `release: prometheus`                                                                                                                                                                                                                                                           |
| metrics.serviceMonitor.enabled                    | bool   | `false`                                                                                                                                                | if enabled, creates a ServiceMonitor instance for Prometheus Operator-based monitoring                                                                                                                                                                                                                                                        |
| nameOverride                                      | string | `""`                                                                                                                                                   | override the release name                                                                                                                                                                                                                                                                                                                     |
| networkPolicy.allowExternal                       | bool   | `true`                                                                                                                                                 | When set to false, only pods with the correct client label will have network access to the ports blaze is listening on. When true, blaze will accept connections from any source (with the correct destination port).                                                                                                                         |
| networkPolicy.allowExternalEgress                 | bool   | `false`                                                                                                                                                | Allow the pod to access any range of port and all destinations.                                                                                                                                                                                                                                                                               |
| networkPolicy.enabled                             | bool   | `false`                                                                                                                                                | Enable creation of NetworkPolicy resources                                                                                                                                                                                                                                                                                                    |
| networkPolicy.extraIngress                        | list   | `[]`                                                                                                                                                   | Add extra ingress rules to the NetworkPolicy e.g: extraIngress: - ports: - port: 1234 from: - podSelector: - matchLabels: - role: frontend - podSelector: - matchExpressions: - key: role operator: In values: - frontend                                                                                                                     |
| networkPolicy.ingressNSMatchLabels                | object | `{}`                                                                                                                                                   | Labels to match to allow traffic from other namespaces                                                                                                                                                                                                                                                                                        |
| networkPolicy.ingressNSPodMatchLabels             | object | `{}`                                                                                                                                                   | Pod labels to match to allow traffic from other namespaces                                                                                                                                                                                                                                                                                    |
| networkPolicy.metrics                             | object | `{"allowExternal":true,"ingressNSMatchLabels":{},"ingressNSPodMatchLabels":{}}`                                                                        | policy access to the metrics endpoint                                                                                                                                                                                                                                                                                                         |
| networkPolicy.metrics.ingressNSMatchLabels        | object | `{}`                                                                                                                                                   | Labels to match to allow traffic from other namespaces                                                                                                                                                                                                                                                                                        |
| networkPolicy.metrics.ingressNSPodMatchLabels     | object | `{}`                                                                                                                                                   | Pod labels to match to allow traffic from other namespaces                                                                                                                                                                                                                                                                                    |
| nodeSelector                                      | object | `{}`                                                                                                                                                   | pod node selector                                                                                                                                                                                                                                                                                                                             |
| persistence                                       | object | `{"accessModes":["ReadWriteOnce"],"annotations":{},"enabled":true,"existingClaim":"","labels":{},"selector":{},"size":"8Gi","storageClass":""}`        | configuration for the server persistence                                                                                                                                                                                                                                                                                                      |
| persistence.accessModes                           | list   | `["ReadWriteOnce"]`                                                                                                                                    | PVC Access Mode for data volume                                                                                                                                                                                                                                                                                                               |
| persistence.annotations                           | object | `{}`                                                                                                                                                   | annotations for the PVC                                                                                                                                                                                                                                                                                                                       |
| persistence.enabled                               | bool   | `true`                                                                                                                                                 | enable data persistence using PVC                                                                                                                                                                                                                                                                                                             |
| persistence.existingClaim                         | string | `""`                                                                                                                                                   | name of an existing PVC to use                                                                                                                                                                                                                                                                                                                |
| persistence.labels                                | object | `{}`                                                                                                                                                   | labels for the PVC                                                                                                                                                                                                                                                                                                                            |
| persistence.selector                              | object | `{}`                                                                                                                                                   | selector to match an existing Persistent Volume (this value is evaluated as a template) selector: matchLabels: app: my-app                                                                                                                                                                                                                    |
| persistence.size                                  | string | `"8Gi"`                                                                                                                                                | PVC Storage Request for volume                                                                                                                                                                                                                                                                                                                |
| persistence.storageClass                          | string | `""`                                                                                                                                                   | PVC Storage Class for data volume If defined, storageClassName: <storageClass> If set to "-", storageClassName: "", which disables dynamic provisioning If undefined (the default) or set to null, no storageClassName spec is set, choosing the default provisioner.                                                                         |
| podAnnotations                                    | object | `{}`                                                                                                                                                   | annotations to set on the main deployment's pod                                                                                                                                                                                                                                                                                               |
| podSecurityContext                                | object | `{"fsGroup":1001,"runAsNonRoot":true}`                                                                                                                 | the pod security context                                                                                                                                                                                                                                                                                                                      |
| replicaCount                                      | int    | `1`                                                                                                                                                    | number of replicas. ⚠️ Blaze does not support running with multiple replicas.                                                                                                                                                                                                                                                                 |
| resources                                         | object | `{}`                                                                                                                                                   | configure the resource requests and limits                                                                                                                                                                                                                                                                                                    |
| resourcesPreset                                   | string | `"medium"`                                                                                                                                             | set container resources according to one common preset (allowed values: none, nano, micro, small, medium, large, xlarge, 2xlarge). This is ignored if primary.resources is set (primary.resources is recommended for production). More information: <https://github.com/bitnami/charts/blob/main/bitnami/common/templates/_resources.tpl#L15> |
| service.metricsPort                               | int    | `8081`                                                                                                                                                 | the port exposed on the service to access metrics on `/metrics`                                                                                                                                                                                                                                                                               |
| service.port                                      | int    | `8080`                                                                                                                                                 | the port for the main endpoint                                                                                                                                                                                                                                                                                                                |
| service.type                                      | string | `"ClusterIP"`                                                                                                                                          | the type of service                                                                                                                                                                                                                                                                                                                           |
| serviceAccount.annotations                        | object | `{}`                                                                                                                                                   | Annotations to add to the service account                                                                                                                                                                                                                                                                                                     |
| serviceAccount.automountServiceAccountToken       | bool   | `false`                                                                                                                                                | whether to automount the SA token.                                                                                                                                                                                                                                                                                                            |
| serviceAccount.create                             | bool   | `false`                                                                                                                                                | Specifies whether a service account should be created.                                                                                                                                                                                                                                                                                        |
| serviceAccount.name                               | string | `""`                                                                                                                                                   | The name of the service account to use. If not set and create is true, a name is generated using the fullname template                                                                                                                                                                                                                        |
| terminologyService                                | object | `{"enabled":false,"loinc":{"enabled":false},"sct":{"enabled":false,"releasePath":""}}`                                                                 | built-in terminology service <https://samply.github.io/blaze/terminology-service.html>                                                                                                                                                                                                                                                        |
| terminologyService.enabled                        | bool   | `false`                                                                                                                                                | enable built-in terminology service                                                                                                                                                                                                                                                                                                           |
| terminologyService.loinc.enabled                  | bool   | `false`                                                                                                                                                | enable LOINC code system                                                                                                                                                                                                                                                                                                                      |
| terminologyService.sct.enabled                    | bool   | `false`                                                                                                                                                | enable SNOMED CT code system (requires releasePath to be set!)                                                                                                                                                                                                                                                                                |
| terminologyService.sct.releasePath                | string | `""`                                                                                                                                                   | set releasePath to folder that provides SCT release                                                                                                                                                                                                                                                                                           |
| tests.automountServiceAccountToken                | bool   | `false`                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                               |
| tests.resources                                   | object | `{}`                                                                                                                                                   | configure the test pods resource requests and limits                                                                                                                                                                                                                                                                                          |
| tests.resourcesPreset                             | string | `"nano"`                                                                                                                                               | set container resources according to one common preset (allowed values: none, nano, micro, small, medium, large, xlarge, 2xlarge). This is ignored if primary.resources is set (primary.resources is recommended for production). More information: <https://github.com/bitnami/charts/blob/main/bitnami/common/templates/_resources.tpl#L15> |
| tolerations                                       | list   | `[]`                                                                                                                                                   | pod tolerations                                                                                                                                                                                                                                                                                                                               |
| topologySpreadConstraints                         | list   | `[]`                                                                                                                                                   | pod topology spread configuration see: <https://kubernetes.io/docs/concepts/workloads/pods/pod-topology-spread-constraints/#api>                                                                                                                                                                                                              |
