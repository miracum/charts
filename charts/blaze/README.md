# blaze

![Type: application](https://img.shields.io/badge/Type-application-informational?style=flat-square)

A Helm chart for deploying Blaze, a FHIR® Server with internal, fast CQL Evaluation Engine.

**Homepage:** <https://github.com/samply/blaze>

## Installation

```sh
helm install blaze oci://ghcr.io/miracum/charts/blaze -n blaze
```

## Values

| Key                                           | Type   | Default                                                                                                                                         | Description                                                                                                                                                                                                                                                                                                                                   |
| --------------------------------------------- | ------ | ----------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| affinity                                      | object | `{}`                                                                                                                                            | pod affinity                                                                                                                                                                                                                                                                                                                                  |
| baseUrl                                       | string | `"http://{{ include \"blaze.fullname\" . }}:{{ .Values.service.port }}"`                                                                        | set the server base URL. Evaluated as a template. Equivalent to setting the `BASE_URL` environment variable.                                                                                                                                                                                                                                  |
| enforceReferentialIntegrity                   | bool   | `true`                                                                                                                                          | whether referential integrity should be enforced. Equivalent to setting the `ENFORCE_REFERENTIAL_INTEGRITY` environment variable.                                                                                                                                                                                                             |
| extraEnv                                      | list   | `[]`                                                                                                                                            | extra environment variables to set on the blaze server container                                                                                                                                                                                                                                                                              |
| fullnameOverride                              | string | `""`                                                                                                                                            | override the full release name                                                                                                                                                                                                                                                                                                                |
| imagePullSecrets                              | list   | `[]`                                                                                                                                            | image pull secrets used by the main deployment container                                                                                                                                                                                                                                                                                      |
| ingress.annotations                           | object | `{}`                                                                                                                                            | extra annotations to apply to the Ingress resource                                                                                                                                                                                                                                                                                            |
| ingress.className                             | string | `""`                                                                                                                                            | ingressClassName to use                                                                                                                                                                                                                                                                                                                       |
| ingress.enabled                               | bool   | `false`                                                                                                                                         | create an Ingress for the application                                                                                                                                                                                                                                                                                                         |
| ingress.hosts                                 | list   | `[{"host":"blaze.127.0.0.1.nip.io","paths":[{"path":"/","pathType":"ImplementationSpecific","portName":"http"}]}]`                              | list of ingress hosts                                                                                                                                                                                                                                                                                                                         |
| ingress.tls                                   | list   | `[]`                                                                                                                                            | TLS configuration                                                                                                                                                                                                                                                                                                                             |
| javaToolOptions                               | string | `"-XX:-OmitStackTraceInFastThrow"`                                                                                                              | sets the value for the `JAVA_TOOL_OPTIONS` environment variable.                                                                                                                                                                                                                                                                              |
| logLevel                                      | string | `"INFO"`                                                                                                                                        | the log level to set. Equivalent to setting the `LOG_LEVEL` environment variable.                                                                                                                                                                                                                                                             |
| metrics.enabled                               | bool   | `true`                                                                                                                                          | Enable the export of Prometheus metrics                                                                                                                                                                                                                                                                                                       |
| metrics.serviceMonitor.additionalLabels       | object | `{}`                                                                                                                                            | additional labels to apply to the ServiceMonitor object, e.g. `release: prometheus`                                                                                                                                                                                                                                                           |
| metrics.serviceMonitor.enabled                | bool   | `false`                                                                                                                                         | if enabled, creates a ServiceMonitor instance for Prometheus Operator-based monitoring                                                                                                                                                                                                                                                        |
| nameOverride                                  | string | `""`                                                                                                                                            | override the release name                                                                                                                                                                                                                                                                                                                     |
| networkPolicy.allowExternal                   | bool   | `true`                                                                                                                                          | When set to false, only pods with the correct client label will have network access to the ports blaze is listening on. When true, blaze will accept connections from any source (with the correct destination port).                                                                                                                         |
| networkPolicy.allowExternalEgress             | bool   | `false`                                                                                                                                         | Allow the pod to access any range of port and all destinations.                                                                                                                                                                                                                                                                               |
| networkPolicy.enabled                         | bool   | `false`                                                                                                                                         | Enable creation of NetworkPolicy resources                                                                                                                                                                                                                                                                                                    |
| networkPolicy.extraIngress                    | list   | `[]`                                                                                                                                            | Add extra ingress rules to the NetworkPolicy e.g: extraIngress: - ports: - port: 1234 from: - podSelector: - matchLabels: - role: frontend - podSelector: - matchExpressions: - key: role operator: In values: - frontend                                                                                                                     |
| networkPolicy.ingressNSMatchLabels            | object | `{}`                                                                                                                                            | Labels to match to allow traffic from other namespaces                                                                                                                                                                                                                                                                                        |
| networkPolicy.ingressNSPodMatchLabels         | object | `{}`                                                                                                                                            | Pod labels to match to allow traffic from other namespaces                                                                                                                                                                                                                                                                                    |
| networkPolicy.metrics                         | object | `{"allowExternal":true,"ingressNSMatchLabels":{},"ingressNSPodMatchLabels":{}}`                                                                 | policy access to the metrics endpoint                                                                                                                                                                                                                                                                                                         |
| networkPolicy.metrics.ingressNSMatchLabels    | object | `{}`                                                                                                                                            | Labels to match to allow traffic from other namespaces                                                                                                                                                                                                                                                                                        |
| networkPolicy.metrics.ingressNSPodMatchLabels | object | `{}`                                                                                                                                            | Pod labels to match to allow traffic from other namespaces                                                                                                                                                                                                                                                                                    |
| nodeSelector                                  | object | `{}`                                                                                                                                            | pod node selector                                                                                                                                                                                                                                                                                                                             |
| persistence                                   | object | `{"accessModes":["ReadWriteOnce"],"annotations":{},"enabled":true,"existingClaim":"","labels":{},"selector":{},"size":"8Gi","storageClass":""}` | configuration for the server persistence                                                                                                                                                                                                                                                                                                      |
| persistence.accessModes                       | list   | `["ReadWriteOnce"]`                                                                                                                             | PVC Access Mode for data volume                                                                                                                                                                                                                                                                                                               |
| persistence.annotations                       | object | `{}`                                                                                                                                            | annotations for the PVC                                                                                                                                                                                                                                                                                                                       |
| persistence.enabled                           | bool   | `true`                                                                                                                                          | enable data persistence using PVC                                                                                                                                                                                                                                                                                                             |
| persistence.existingClaim                     | string | `""`                                                                                                                                            | name of an existing PVC to use                                                                                                                                                                                                                                                                                                                |
| persistence.labels                            | object | `{}`                                                                                                                                            | labels for the PVC                                                                                                                                                                                                                                                                                                                            |
| persistence.selector                          | object | `{}`                                                                                                                                            | selector to match an existing Persistent Volume (this value is evaluated as a template) selector: matchLabels: app: my-app                                                                                                                                                                                                                    |
| persistence.size                              | string | `"8Gi"`                                                                                                                                         | PVC Storage Request for volume                                                                                                                                                                                                                                                                                                                |
| persistence.storageClass                      | string | `""`                                                                                                                                            | PVC Storage Class for data volume If defined, storageClassName: <storageClass> If set to "-", storageClassName: "", which disables dynamic provisioning If undefined (the default) or set to null, no storageClassName spec is set, choosing the default provisioner.                                                                         |
| podAnnotations                                | object | `{}`                                                                                                                                            | annotations to set on the main deployment's pod                                                                                                                                                                                                                                                                                               |
| podSecurityContext                            | object | `{"fsGroup":1001,"runAsNonRoot":true}`                                                                                                          | the pod security context                                                                                                                                                                                                                                                                                                                      |
| replicaCount                                  | int    | `1`                                                                                                                                             | number of replicas. ⚠️ Blaze does not support running with multiple replicas.                                                                                                                                                                                                                                                                 |
| resources                                     | object | `{}`                                                                                                                                            | configure the resource requests and limits                                                                                                                                                                                                                                                                                                    |
| resourcesPreset                               | string | `"medium"`                                                                                                                                      | set container resources according to one common preset (allowed values: none, nano, micro, small, medium, large, xlarge, 2xlarge). This is ignored if primary.resources is set (primary.resources is recommended for production). More information: <https://github.com/bitnami/charts/blob/main/bitnami/common/templates/_resources.tpl#L15> |
| service.metricsPort                           | int    | `8081`                                                                                                                                          | the port exposed on the service to access metrics on `/metrics`                                                                                                                                                                                                                                                                               |
| service.port                                  | int    | `8080`                                                                                                                                          | the port for the main endpoint                                                                                                                                                                                                                                                                                                                |
| service.type                                  | string | `"ClusterIP"`                                                                                                                                   | the type of service                                                                                                                                                                                                                                                                                                                           |
| serviceAccount.annotations                    | object | `{}`                                                                                                                                            | Annotations to add to the service account                                                                                                                                                                                                                                                                                                     |
| serviceAccount.automountServiceAccountToken   | bool   | `false`                                                                                                                                         | whether to automount the SA token.                                                                                                                                                                                                                                                                                                            |
| serviceAccount.create                         | bool   | `false`                                                                                                                                         | Specifies whether a service account should be created.                                                                                                                                                                                                                                                                                        |
| serviceAccount.name                           | string | `""`                                                                                                                                            | The name of the service account to use. If not set and create is true, a name is generated using the fullname template                                                                                                                                                                                                                        |
| terminologyService                            | object | `{"enabled":false,"loinc":{"enabled":false},"sct":{"enabled":false,"releasePath":""}}`                                                          | built-in terminology service https://samply.github.io/blaze/terminology-service.html                                                                                                                                                                                                                                                          |
| tests.automountServiceAccountToken            | bool   | `false`                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                               |
| tests.resources                               | object | `{}`                                                                                                                                            | configure the test pods resource requests and limits                                                                                                                                                                                                                                                                                          |
| tests.resourcesPreset                         | string | `"nano"`                                                                                                                                        | set container resources according to one common preset (allowed values: none, nano, micro, small, medium, large, xlarge, 2xlarge). This is ignored if primary.resources is set (primary.resources is recommended for production). More information: <https://github.com/bitnami/charts/blob/main/bitnami/common/templates/_resources.tpl#L15> |
| tolerations                                   | list   | `[]`                                                                                                                                            | pod tolerations                                                                                                                                                                                                                                                                                                                               |
| topologySpreadConstraints                     | list   | `[]`                                                                                                                                            | pod topology spread configuration see: <https://kubernetes.io/docs/concepts/workloads/pods/pod-topology-spread-constraints/#api>                                                                                                                                                                                                              |
